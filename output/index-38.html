<!DOCTYPE html>
<html prefix="og: http://ogp.me/ns# article: http://ogp.me/ns/article# " lang="es">
    <head>
    <meta charset="utf-8">
    <meta name="description" content="el blog de Juanjo Conti - abstracto, lúdico y digital">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>En borrador permanente (publicaciones antiguas, página 38) | En borrador permanente</title>

    
            <link href="assets/css/all-nocdn.css" rel="stylesheet" type="text/css">

    
            <link rel="alternate" type="application/rss+xml" title="RSS" href="rss.xml">

      <link rel="canonical" href="http://www.juanjoconti.com.ar/index-38.html">



        <link rel="prev" href="index-39.html" type="text/html">
        <link rel="next" href="index-37.html" type="text/html">

    
        <!--[if lt IE 9]><script src="assets/js/html5.js"></script><![endif]-->

    




</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Ir al contenido principal</a>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-fixed-top" role="navigation">
    <div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="http://www.juanjoconti.com.ar/">

                <span id="blog-title">En borrador permanente</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse navbar-ex1-collapse">
            <ul class="nav navbar-nav">
                
                <li>
<a href="archive.html">Archives</a>
                </li>
<li>
<a href="categories/index.html">Tags</a>
                </li>
<li>
<a href="rss.xml">RSS feed</a>

                
            </li>
</ul>

            <ul class="nav navbar-nav navbar-right">
                
                
                    
                
            </ul>
        </div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav>

<!-- End of Menubar -->

<div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            
<div class="postindex">
    <article class="h-entry post-text">
    <header>
        <h1 class="p-name entry-title"><a href="posts/2010/08/20/el-hosting-para-django-mas-barato.html" class="u-url">El hosting para Django más barato</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn">Juanjo</span></p>
            <p class="dateline"><a href="posts/2010/08/20/el-hosting-para-django-mas-barato.html" rel="bookmark"><time class="published dt-published" datetime="2010-08-20T13:40:23+00:00" title="2010-08-20 13:40">2010-08-20 13:40</time></a></p>
                <p class="commentline">
        
    <a href="posts/2010/08/20/el-hosting-para-django-mas-barato.html#disqus_thread" data-disqus-identifier="cache/posts/2010/08/20/el-hosting-para-django-mas-barato.html">Comments</a>


        </p>
</div>
    </header>
    <div class="e-content entry-content">
    <div>
<p></p>
<p>Hace un tiempo <a href="http://www.juanjoconti.com.ar/2008/11/24/el-mejor-hosting-para-django/" target="_blank">recomendé Webfaction</a> como el mejor hosting para Django (debe aún serlo). Pero algunas veces no queremos el mejor, con el más barato nos alcanza :D</p>
<p>Tal vez son un adolecente aprendiendo a programar, o simplemente rata. Para un programador PHP es bastante fácil encontrar un hosting en Internet que le de un servicio gratuito, subir sus cosas y mostrarlas al mundo. Cuando programás en Django... es más difícil.</p>
<p>Hasta hoy; les paso el dato: <a href="http://www.alwaysdata.com/" target="_blank">AlwaysData.com</a></p>
<p><em><strong>Hosting Django gratuito. </strong></em></p>
<p>Tengo 2 cuentas funcionando muy bien. Y no se asusten por que está en francés (eso me detuvo la primer vez que lo vi); luego de sacar la cuenta tenés acceso al panel de administración que está en muchos idiomas; incluyendo español. Tenés para elegir distintas versiones de Python y Djando, MySQL o PosgreSQL, acceso SHELL, FTP y WebDAV. Qué más querés?</p>
<p>También podés tener PHP o Ruby on Rails.</p>
<p>Espero les sirva.</p>
</div>
    </div>
    </article>
    <article class="h-entry post-text">
    <header>
        <h1 class="p-name entry-title"><a href="posts/2010/08/16/borges-hacker.html" class="u-url">Borges hacker</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn">Juanjo</span></p>
            <p class="dateline"><a href="posts/2010/08/16/borges-hacker.html" rel="bookmark"><time class="published dt-published" datetime="2010-08-16T23:01:19+00:00" title="2010-08-16 23:01">2010-08-16 23:01</time></a></p>
                <p class="commentline">
        
    <a href="posts/2010/08/16/borges-hacker.html#disqus_thread" data-disqus-identifier="cache/posts/2010/08/16/borges-hacker.html">Comments</a>


        </p>
</div>
    </header>
    <div class="e-content entry-content">
    <div>
<p></p>
<p>Dijo nuestro escritor por excelencia:</p>
<p><a href="wp-content/uploads/2010/08/Jorgeluisborges2.jpg"><img class="alignright size-medium wp-image-2691" title="Jorgeluisborges2" src="wp-content/uploads/2010/08/Jorgeluisborges2-192x300.jpg" alt="" width="192" height="300"></a></p>
<p></p>
<blockquote>"Uno llega a ser grande por lo que lee y no por lo que escribe."
<p><a href="http://es.wikipedia.org/wiki/Jorge_Luis_Borges" target="_blank">BORGES, Jorge Luis</a></p>
<p>Escritor argentino.</p>
</blockquote>
<p>Años más tarde, desde los más oscuros rincones de la web 2.0 y las redes sociales, el espíritu del poeta infunde a la juventud. Distinto oficio, misma verdad:</p>
<blockquote>Los mejores programadores no son los que más código escriben, sino los que más código leen.



<a href="http://twitter.com/alejolp/status/21351513522" target="_blank">@alejolp</a>
</blockquote>

<p></p>
</div>
    </div>
    </article>
    <article class="h-entry post-text">
    <header>
        <h1 class="p-name entry-title"><a href="posts/2010/08/15/lo-que-todo-programdor-deberia-saber-sobre.html" class="u-url">Lo que todo programdor debería saber sobre...</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn">Juanjo</span></p>
            <p class="dateline"><a href="posts/2010/08/15/lo-que-todo-programdor-deberia-saber-sobre.html" rel="bookmark"><time class="published dt-published" datetime="2010-08-15T21:46:54+00:00" title="2010-08-15 21:46">2010-08-15 21:46</time></a></p>
                <p class="commentline">
        
    <a href="posts/2010/08/15/lo-que-todo-programdor-deberia-saber-sobre.html#disqus_thread" data-disqus-identifier="cache/posts/2010/08/15/lo-que-todo-programdor-deberia-saber-sobre.html">Comments</a>


        </p>
</div>
    </header>
    <div class="e-content entry-content">
    <div>
<p></p>
<p>Hace un par de días hablábamos con una compañera sobre NO USAR el tipo de datos float para manejar dinero:</p>
<p></p>
<pre>&gt;&gt;&gt; 0.1 + 0.3
<p>0.40000000000000002</p>
</pre>

<p>A no alarmarse, lo anterior sucede en todos los lenguajes de programación; aunque algunos lo ocultan más que otros. La charla terminó con la recomendación de revisar un sitio web que explica el tema de forma muy consisa:</p>
<p><a href="http://floating-point-gui.de/" target="_blank"><strong>What Every Programmer Should Know About Floating-Point Arithmetic</strong></a></p>
<p>Además de explicar <a href="http://floating-point-gui.de/formats/fp/" target="_blank">cómo funciona el tipo de datos float</a> y <a href="http://floating-point-gui.de/formats/exact/" target="_blank">cómo solucionar el problema</a>, da machetes para varios lenguajes de programación (C#, Java, JavaScript, PHP y SQL).</p>
<p>Me sorprendió que no haya una para Python, por lo que seguí el mandato del autor del sitio web, <a href="http://github.com/brazzy/floating-point-gui.de" target="_blank">fork me on github</a>, y envié mis cambios. <strong>update:</strong> <a href="http://floating-point-gui.de/languages/python/" target="_blank">ya está disponible</a> en el sitio web.</p>
<p>Siguiendo con el título del posts, me puse a buscar otros artículos con el formato: <em>Lo que todo programador debería saber sobre...</em> y encontré estos:</p>
<ul>

    <li><a href="http://www.joelonsoftware.com/articles/Unicode.html" target="_blank">The Absolute Minimum Every Software Developer Absolutely, Positively Must Know About Unicode and Character Sets (No Excuses!)</a></li>

    <li><a href="http://lwn.net/Articles/250967/" target="_blank">What every programmer should know about memory</a></li>

    <li><a href="http://www.skorks.com/2010/05/what-every-developer-should-know-about-urls/" target="_blank">What Every Developer Should Know About URLs</a></li>

</ul>

<p></p>
</div>
    </div>
    </article>
    <article class="h-entry post-text">
    <header>
        <h1 class="p-name entry-title"><a href="posts/2010/08/13/salio-la-revista-de-pyar.html" class="u-url">Salió la revista de PyAr</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn">Juanjo</span></p>
            <p class="dateline"><a href="posts/2010/08/13/salio-la-revista-de-pyar.html" rel="bookmark"><time class="published dt-published" datetime="2010-08-13T10:33:32+00:00" title="2010-08-13 10:33">2010-08-13 10:33</time></a></p>
                <p class="commentline">
        
    <a href="posts/2010/08/13/salio-la-revista-de-pyar.html#disqus_thread" data-disqus-identifier="cache/posts/2010/08/13/salio-la-revista-de-pyar.html">Comments</a>


        </p>
</div>
    </header>
    <div class="e-content entry-content">
    <div>
<p></p>
<p>Hoy salió a la calle (del cyberespacio) el <a href="http://revista.python.org.ar/1/html/" target="_blank">número 1</a> de <a href="http://revista.python.org.ar" target="_blank">PET, Python Entre Todos</a>, la revista de la comunidad Python Argentina.</p>
<p><a href="wp-content/uploads/2010/08/tapa-nro1.jpg"><img class="aligncenter size-large wp-image-2673" title="tapa-nro1" src="wp-content/uploads/2010/08/tapa-nro1-1024x724.jpg" alt="" width="640" height="452"></a>Cuando empezaron a organizarla no tenía tiempo para prestarle mucha atención, pero un par de semanas antes de que esté lista pude colaborar un poco más y mandé un artículo sobre <a href="http://revista.python.org.ar/1/html/taint.html" target="_blank">Taint Mode</a>, <a href="http://revista.python.org.ar/1/html/desafio.html" target="_blank">un desafío</a> y e hice un poquito de revisor. Espero en la próxima edición colaborar un poco más; en esta primera vuelta todo el trabajo de edición recayó sobre Roberto Alsina y Emiliano Dalla Verde Marcozzi.</p>
<p>Destaco hasta ahora de los que leí, un <a href="http://revista.python.org.ar/1/html/genesispyar.html" target="_blank">artículo sobre la historia del grupo</a>, pero tengo muchos más en la cola de lectura!</p>
<p>¿Qué hacés que todavía no fuiste a leer? <a href="http://revista.python.org.ar/1/html/" target="_blank">Está disponible en varios formatos</a>!</p>
</div>
    </div>
    </article>
    <article class="h-entry post-text">
    <header>
        <h1 class="p-name entry-title"><a href="posts/2010/08/08/argparse-command-line-option-and-argument-parsing.html" class="u-url">argparse - Command line option and argument parsing</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn">Juanjo</span></p>
            <p class="dateline"><a href="posts/2010/08/08/argparse-command-line-option-and-argument-parsing.html" rel="bookmark"><time class="published dt-published" datetime="2010-08-08T12:30:03+00:00" title="2010-08-08 12:30">2010-08-08 12:30</time></a></p>
                <p class="commentline">
        
    <a href="posts/2010/08/08/argparse-command-line-option-and-argument-parsing.html#disqus_thread" data-disqus-identifier="cache/posts/2010/08/08/argparse-command-line-option-and-argument-parsing.html">Comments</a>


        </p>
</div>
    </header>
    <div class="e-content entry-content">
    <div>
<p></p>
<p>Hoy recibí la <a href="http://blog.doughellmann.com/2010/08/pymotw-argparse-command-line-option-and.html" target="_blank">última edición</a> de <a href="http://www.doughellmann.com/PyMOTW/" target="_blank">Python Module of the Week</a>, un semanal de Doug Hellmann sobre módulos de Python. Leo:</p>
<p></p>
<blockquote>The <code>argparse</code> module was added to Python 2.7 as a replacement
<p>for <code>optparse</code>.</p>
</blockquote>
<p>Nunca había usando <code>optparse</code> hasta hace un par de meses y estaba contento de haberlo empezado a usar, ordenaba mis programas de línea de comando con bonitos parámetros. ¿Tengo que aprender otro sistema totalmente nuevo? Veamos.<!--more--></p>
<p>Esta es una parte de mi programa original:</p>
<pre>from optparse import OptionParser

parser = OptionParser(usage="rpcping ip [-p port] [-r rep] [-s size]", version="rpcping 1.0")



parser.add_option("-p", type="int", dest="port", default=PORT)

parser.add_option("-r", type="int", dest="rep", default=REP)

parser.add_option("-s", type="int", dest="size", default=SIZE)

(options, args) = parser.parse_args()



if not args:

    parser.error("se necesita la direccion ip del servidor como argumento posicional.")

else:

    ip = args[0]



if not 1024 &lt; options.port &lt; 65535:

    parser.error("el puerto debe ser mayor a 1024 y menor a 65535.")

else:

    port = options.port



if not 0 &lt; options.rep &lt; 101:

    parser.error("las repeticiones deben ser mayores a 0 y menores a 101.")

else:

    rep = options.rep



if not 0 &lt; options.size &lt; 10001:

    parser.error("el tamaño deben ser mayores a 0 y menores a 10001.")

else:

    size = options.size

</pre>

<p>Qué tuve que cambiar para que funcione con <code>argparse</code>:</p>
<ul>

    <li>Cambiar nombres; <code>optparse</code> por <code>argparse</code>, <code>OptionParser</code> por <code>ArgumentParser</code>,<code> add_option</code> por <code>add_argument</code>.</li>

    <li>Cambiar el valor del agumento <code>type</code> de string a un tipo de verdad. En mi caso <code>type="int</code>" por <code>type=int</code>.</li>

    <li>Si tratamos de obtener el resultado del parsing así <code>(options, args) = parser.parse_args()</code>, vamos a tener un error <code>TypeError: 'Namespace' object is not iterable</code>. El nombre <code>result</code> en el nuevo código está asociado a un objeto del tipo <code>Namespace</code>.</li>

    <li>
<code>optparse</code> no trabaja con argumentos obligatorios, por lo que para el argumento ip había tenido que escribir código extra por mi cuenta. En <code>argparse</code> es más simple.</li>

</ul>

<p>El resultado es:</p>
<pre>from argparse import ArgumentParser

parser = ArgumentParser(description="Realiza ping via RPC contra un servidor", version="rpcping 1.0")



parser.add_argument("ip")

parser.add_argument("-p", type=int, dest="port", default=PORT)

parser.add_argument("-r", type=int, dest="rep", default=REP)

parser.add_argument("-s", type=int, dest="size", default=SIZE)

result = parser.parse_args()



ip = result.ip



if not 1024 &lt; result.port &lt; 65535:

    parser.error("el puerto debe ser mayor a 1024 y menor a 65535.")

else:

    port = result.port



if not 0 &lt; result.rep &lt; 101:

    result.error("las repeticiones deben ser mayores a 0 y menores a 101.")

else:

    rep = result.rep



if not 0 &lt; result.size &lt; 10001:

    parser.error("el tamaño deben ser mayores a 0 y menores a 10001.")

else:

    size = result.size

</pre>

<p>Parece que con poco esfuerzo se puede migrar de <code>optparse</code> a <code>argparse</code> y luego empezar a estudiar las nuevas funcionalidades que incorpora.</p>
<blockquote>The implementation of <code>argparse</code> supports features that would not have been easy to add to <code>optparse</code>, and that would have required backwards-incompatible API changes, so a new module was brought into the library instead. <code>optparse</code> is still supported, but is not likely to receive new features.</blockquote>

<p>Más en: <a href="http://www.doughellmann.com/PyMOTW/argparse/" target="_blank">PyMOTW: argparse - Command line option and argument parsing</a>.</p>
</div>
    </div>
    </article>
    <article class="h-entry post-text">
    <header>
        <h1 class="p-name entry-title"><a href="posts/2010/08/07/functools-update_wrapper.html" class="u-url">functools.update_wrapper</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn">Juanjo</span></p>
            <p class="dateline"><a href="posts/2010/08/07/functools-update_wrapper.html" rel="bookmark"><time class="published dt-published" datetime="2010-08-07T15:17:30+00:00" title="2010-08-07 15:17">2010-08-07 15:17</time></a></p>
                <p class="commentline">
        
    <a href="posts/2010/08/07/functools-update_wrapper.html#disqus_thread" data-disqus-identifier="cache/posts/2010/08/07/functools-update_wrapper.html">Comments</a>


        </p>
</div>
    </header>
    <div class="e-content entry-content">
    <div>
<p></p>
<p>Este post se alinea con la serie Decoradores en Python (<a href="http://www.juanjoconti.com.ar/2008/07/11/decoradores-en-python-i/" target="_blank">I</a>, <a href="http://www.juanjoconti.com.ar/2009/07/16/decoradores-en-python-ii/" target="_blank">II</a>, <a href="http://www.juanjoconti.com.ar/2009/12/30/decoradores-en-python-iii/" target="_blank">III</a>) pero no es tan elaborado como para ser Decoradores en Python (IV) :)</p>
<p>Desde Python 2.5, al crear un decorador, se puede utilizar <a href="http://docs.python.org/library/functools.html" target="_blank">functools.update_wrapper</a> para quela versión decorada de la función, tenga los atributos  <strong>name</strong>, <strong>doc</strong>, <strong>module</strong> y <strong>dict</strong> de la función original.</p>
<p></p>
<pre>&gt;&gt;&gt; import functools
<p>&gt;&gt;&gt; def deco(f):</p>
<p>...     def inner(<em>a, </em>*kw):</p>
<p>...             print "Este decorador no hace nada"</p>
<p>...             return f(<em>a, </em>*kw)</p>
<p>...     return inner</p>
<p>...</p>
<p>&gt;&gt;&gt; def saludo():</p>
<p>...     print "hola"</p>
<p>...</p>
<p>&gt;&gt;&gt; saludo2 = deco(saludo)</p>
<p>&gt;&gt;&gt; saludo2()</p>
<p>Este decorador no hace nada</p>
<p>hola</p>
<p>&gt;&gt;&gt; saludo2.<strong>name</strong></p>
<p>'inner'</p>
<p>&gt;&gt;&gt; def deco(f):</p>
<p>...     def inner(<em>a, </em>*kw):</p>
<p>...             print "Este decorador no hace nada"</p>
<p>...             return f(<em>a, </em>*kw)</p>
<p>...     return functools.update_wrapper(inner, f)</p>
<p>...</p>
<p>&gt;&gt;&gt; saludo3 = deco(saludo)</p>
<p>&gt;&gt;&gt; saludo3()</p>
<p>Este decorador no hace nada</p>
<p>hola</p>
<p>&gt;&gt;&gt; saludo3.<strong>name</strong></p>
<p>'saludo'</p>
<p>&gt;&gt;&gt; saludo = saludo3</p>
<p></p></pre>
</div>
    </div>
    </article>
    <article class="h-entry post-text">
    <header>
        <h1 class="p-name entry-title"><a href="posts/2010/08/06/puedo-disfrazar-cualquier-cosa-de-modbus.html" class="u-url">Puedo disfrazar cualquier cosa de Modbus</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn">Juanjo</span></p>
            <p class="dateline"><a href="posts/2010/08/06/puedo-disfrazar-cualquier-cosa-de-modbus.html" rel="bookmark"><time class="published dt-published" datetime="2010-08-06T00:05:49+00:00" title="2010-08-06 00:05">2010-08-06 00:05</time></a></p>
                <p class="commentline">
        
    <a href="posts/2010/08/06/puedo-disfrazar-cualquier-cosa-de-modbus.html#disqus_thread" data-disqus-identifier="cache/posts/2010/08/06/puedo-disfrazar-cualquier-cosa-de-modbus.html">Comments</a>


        </p>
</div>
    </header>
    <div class="e-content entry-content">
    <div>
<p></p>
<p>Hace más de un año participo en un proyecto de desarrollo de un sistema <a href="http://es.wikipedia.org/wiki/SCADA" target="_blank">SCADA</a>, específicamente en la capa de comunicación. La distribución física es algo como esto:</p>
<p><a href="wp-content/uploads/2010/08/esquema_kimera.jpg"><img class="aligncenter size-large wp-image-2589" title="esquema_kimera" src="wp-content/uploads/2010/08/esquema_kimera-1024x595.jpg" alt="" width="640" height="371"></a>En cada edificio hay una <a href="http://es.wikipedia.org/wiki/RS-485" target="_blank">red 485</a> con dispositivos de hardware propio (aka Robot) y un módulo celular (Motorolla G24) con salida a Internet vía GPRS. Esos módulos se registran en un servidor (escrito con <a href="http://twistedmatrix.com/" target="_blank">Twisted</a>) para ser luego sondeados: se registran sus mediciones, hay gráficos en tiempo real, se puede hacer telecomando y encender un equipo a la distancia o cambiar un set point; entre otras cosas.</p>
<p>Nuestra primera implementación estaba inspirada en el protocolo Modbus ASCII, pero bastante alejada del estándar. Nos sirvió por bastante tiempo y no apegarnos a una especificación nos permitió acelerar el desarrollo; especialmente del hardware.</p>
<p>Modbus es un protocolo de línea maestro/esclavo en donde el maestro realiza peticiones de lectura o escritura sobre algún o algunos registros en un esclavo. El protocolo define 4 tipos de registros (analógicos o digitales, de solo lectura o lectura-escritura) y fue pensado para funcionar sobre una línea serie; existen dos sabores: RTU, dónde los datos viajan en forma binaria y la ocupación del canal es optimizada y ASCII, menos eficiente pero legible por humanos. Se puedo leer más al respecto en <a href="http://es.wikipedia.org/wiki/Modbus" target="_blank">Wikipedia</a> o en la <a href="http://www.modbus.org/" target="_blank">página oficial del protocolo</a>.</p>
<p>Hace algunos meses empezamos a utilizar <a href="http://mango.serotoninsoftware.com/" target="_blank">Mango m2m</a>. Mango tiene todos los componentes de interfaz de usuario que se pueden necesitar en un SCADA en adición a la posibilidad de conectarle distintas fuentes de datos (desde Modbus Serie a un motor de base de datos); las más interesante para nosotros es Modbus TCP.</p>
<p><a href="wp-content/uploads/2010/08/mango.jpg"></a><a href="wp-content/uploads/2010/08/mango.jpg"><img class="aligncenter size-full wp-image-2603" title="mango" src="wp-content/uploads/2010/08/mango.jpg" alt="" width="572" height="413"></a></p>
<p>Modbus TCP extiende el protocolo original para poder utilizarlo sobre la red de redes en lugar de sobre una línea serie. Por ejemplo, una de las cosas que hace es agregar al paquete enviado un número consecutivo para solucionar el problema de paquetes perdidos o duplicados.</p>
<p>Teníamos entonces, por un lado Mango que sabe hablar Modbus TCP y por el otro los robotitos hablando un dialecto de Modbus ASCII. En el medio, el servidor de comunicaciones. La pregunta en este punto era cómo unir ambos extremos, de manera de aprovechar esta herramienta que soluciona muchos de nuestros requerimientos.</p>
<p>Allí es donde entra en acción <a href="http://code.google.com/p/pymodbus/" target="_blank">pymodbus</a>, una implementación en Python del stack Modbus. No solo está escrita en Python, sino que está implementada utilizando el framework Twisted, el mismo que venía usando para el servidor de comunicaciones. Utilizando pymodbus pude engañar a Mango y hacerle creer que hablaba contar dispositivos Modbus TCP cuando en realidad interceptaba sus peticiones, enviaba los comandos necesarios a los robots y contestaba con la respuesta correcta.</p>
<p>En el camino encontré varios problemas en la librería, los fui reportando y enviando parches para solucionarlos. A lo último eran tanto los cambios que enviaba y empecé a modificar el core de la librería para que funcione con <a href="http://twistedmatrix.com/documents/current/core/howto/defer.html" target="_blank">deferrers</a> (es decir, siguiendo la filosofía de Twisted) que <a href="http://code.google.com/p/pymodbus/people/list" target="_blank">recibí permiso de commit</a> en la rama <a href="http://code.google.com/p/pymodbus/source/browse/#svn/branches/devel" target="_blank">devel</a>.</p>
<p><em>Nota: el esquema descripto funcionó bastante tiempo. Actualmente seguimos avanzando y los robots ya hablan Modbus ASCII estándar a la vez que el componente intermedio adelgazó para convertirse en un traductor o gateway.</em></p>
</div>
    </div>
    </article>
    <article class="h-entry post-text">
    <header>
        <h1 class="p-name entry-title"><a href="posts/2010/08/05/coloreando-codigo-fuente-en-wordpress.html" class="u-url">Coloreando código fuente en WordPress</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn">Juanjo</span></p>
            <p class="dateline"><a href="posts/2010/08/05/coloreando-codigo-fuente-en-wordpress.html" rel="bookmark"><time class="published dt-published" datetime="2010-08-05T00:54:15+00:00" title="2010-08-05 00:54">2010-08-05 00:54</time></a></p>
                <p class="commentline">
        
    <a href="posts/2010/08/05/coloreando-codigo-fuente-en-wordpress.html#disqus_thread" data-disqus-identifier="cache/posts/2010/08/05/coloreando-codigo-fuente-en-wordpress.html">Comments</a>


        </p>
</div>
    </header>
    <div class="e-content entry-content">
    <div>
<p></p>
<p>Tengo este blog hace unos 5 años y en él tengo muchos posts con código fuente, pero nunca usé un plug-in para hacer <strong>syntax highlight</strong> o resaltado de sintáxis, es decir que las distintas partes del código fuente se pinten de distintos colores según su significado. Mi idea es solucionarlo.</p>
<p>El escenario es bastante complicado. Hay bloques de código en los que uso la etiqueta HTML &lt;pre&gt; y otros en los que uso la etiqueda &lt;code&gt;. También tengo código in-line (es decir líeas de código que forman parte de una oración) arcadas con la etiqueta &lt;code&gt;.</p>
<!--more-->

<p></p>
<h3>¿Qué busco?</h3>
<ul>

    <li>No quiero posts con código coloreado de ahora en adelante y que los anteriores

sigan en blanco y negro.</li>

    <li>No quiero tener que editar cada posts para agregar algún atributo en las

etiquetas pre o code. Por ejemplo, muchos plug-ins te piden que marques el código

con algo como &lt;pre lang="python"&gt; o similar.</li>

    <li>Quiero que los bloques de código &lt;pre&gt; y &lt;code&gt; se vean igual.</li>

</ul>

<p>Luego de buscar un poco, decidí instalar y probar estos plug-ins:</p>
<ul>

    <li>
<a href="http://wordpress.org/extend/plugins/wp-synhighlight/" target="_blank">WP-SynHighlight</a> (lo descarté enseguida, tiene una GUI pesada con muchas opciones y las marcas que introduce en el post son bastante poco estándar e intrusivas)</li>

    <li>
<a href="http://wordpress.org/extend/plugins/wp-syntax/" target="_self">WP-Syntax</a> (usa <a href="http://qbnz.com/highlighter/" target="_blank">GeSHI</a>, por lo que el coloreado se realiza en el lado del servidor)</li>

    <li>
<a href="http://wordpress.org/extend/plugins/jquery-syntax/" target="_blank">JQuery.Syntax</a> (hecho con la popular librería de JavaScript)</li>

    <li>
<a href="http://wordpress.org/extend/plugins/google-code-prettify-for-wordpress/" target="_self">Google Code Prettify</a> (está basado en tecnología de Google y posiblemente lo hayan visto en acción en <a href="http://stackoverflow.com/" target="_blank">StackOverflow</a>. Su principal ventaja es que <strong>no requiere decirle en qué lenguaje está escrita la porción de código</strong>, sino que este lo adivina)</li>

</ul>

<p>Intentar empezar a usar uno de estos plug-ins ahora, me genera un gran problema</p>
<p>de compatibilidad hacia atrás :)</p>
<p>Veamos... <strong>WP-SynHighlight</strong> no me gustó de arranque. Modifica la GUI del editor WYSIWYG the WordPress, uno selecciona una porción de código, aprieta el botón y te da unas 10 opciones para elegir (desde lenguaje hasta el número de espacios para los tabs). Puede funcionar para algún tipo de usuario, pero no para un programador. Además agrega bastante código sucio al HTML del post. Paso.</p>
<p>El segundo que probé fue <strong>WP-Syntax</strong>. Me gustó mucho, entre otras cosas:</p>
<ul>

    <li> Usa CSS in-line para que el código coloreado se mantenga incluso si el posts no es leído en el blog; por ejemplo en un planeta o por RSS.</li>

    <li>Si el texto es más ancho que la página, agrega una barra de desplazamiento en la cajita de código.<a href="wp-content/uploads/2010/08/wpsyntax.jpg"><img class="aligncenter size-full wp-image-2581" title="wpsyntax" src="wp-content/uploads/2010/08/wpsyntax.jpg" alt="" width="235" height="250"></a>
</li>

</ul>

<p>Luego probé JQuery.Syntax y Google Code Prettify. Estos funcionan de la siguiente forma: luego de que se carga el HTML del sitio, corre código JavaScript que se encarga del coloreado. Esto hace que la carga de la página sea más lenta.</p>
<p><a href="wp-content/uploads/2010/08/jquery.jpg"><img class="aligncenter size-full wp-image-2582" title="jquery" src="wp-content/uploads/2010/08/jquery.jpg" alt="" width="244" height="230"></a></p>
<h3>¿Qué hice?</h3>

<p>Me decidí a usar WP-Syntax y para no editar todos los bloques de código, creé un pequeño plug-in para WordPress que cambia todos los &lt;pre&gt; por &lt;pre lang="python" escaped="true"&gt;, cambié a mano los pocos bloques code que tenía por bloques pre y agregué a mano la especificación para los bloques de código que no son Python (no eran muchos).</p>
<p>Tampoco tengo coloreado del código in-line. De las opciones que probé solo el plug-in que usa tecnología de Google, tenía esta característica.</p>
<p>Si ven algún post en el que algo no quedó del todo bien, avisen!</p>
</div>
    </div>
    </article>
    <article class="h-entry post-text">
    <header>
        <h1 class="p-name entry-title"><a href="posts/2010/07/24/diccionario-bidireccional-en-python.html" class="u-url">Diccionario bidireccional en Python</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn">Juanjo</span></p>
            <p class="dateline"><a href="posts/2010/07/24/diccionario-bidireccional-en-python.html" rel="bookmark"><time class="published dt-published" datetime="2010-07-24T18:59:50+00:00" title="2010-07-24 18:59">2010-07-24 18:59</time></a></p>
                <p class="commentline">
        
    <a href="posts/2010/07/24/diccionario-bidireccional-en-python.html#disqus_thread" data-disqus-identifier="cache/posts/2010/07/24/diccionario-bidireccional-en-python.html">Comments</a>


        </p>
</div>
    </header>
    <div class="e-content entry-content">
    <div>
<p></p>
<p>Bidirectional dict o <a href="http://en.wikipedia.org/wiki/Injective_mapping" target="_blank">Injective mapping</a> es una estructura de datos muy útil.</p>
<p>Por lo general cuando usamos un diccionario o tabla hash, tenemos un valor asociado a una clave:</p>
<p></p>
<pre>&gt;&gt;&gt; d = {1:'uno', 2:'dos'}
<p>&gt;&gt;&gt; d[1]</p>
<p>'uno'</p></pre>
<p>Pero algunas veces también resulta útil indexar por el valor y obtener la clave.</p>
<pre lang="python" escaped="true">&gt;&gt;&gt; d['uno']

1</pre>

<p>Por ejemplo, en un programa tengo un archivo de configuración que contiene un diccionario dónde las claves son strings de 3 caracteres representando un edificio ('SFE', 'GDP', ...) y las claves números de puerto (5007, 5008, ...). En algunas partes el programa requiere conocer el edificio a partir del número de puerto y en otras el puerto a partir del edificio.</p>
<h3>¿Cómo obtenemos este comportamiento?</h3>

<p>Pregunté en <a href="http://stackoverflow.com/questions/3318625/efficient-bidirectional-hash-table-in-python" target="_blank">StackOverflow</a> y si bien me apuntaron a una <a href="http://pypi.python.org/pypi/bidict/" target="_blank">implementación</a>, la solución que más me gustó fue esta:</p>
<pre>&gt;&gt;&gt; d.update( dict((d[k], k) for k in d))</pre>

<p>Así se ve <code>d</code> ahora: </p>
<pre>{1: 'uno', 2: 'dos', 'uno': 1, 'dos': 2}</pre>
<p>Y podemos efectivamente indexar por clave o por valor:</p>
<pre>&gt;&gt;&gt; d[1]

'uno'

&gt;&gt;&gt; d['uno']

1

</pre>

<h3>Advertencias</h3>

<h4>No se pueden usar objetos mutables</h4>

<p>En los diccionarios de Python <a href="http://www.python.org/doc/faq/es/general/#por-qu-las-claves-de-los-diccionarios-deben-ser-inmutables" target="_blank">solo objetos inmutables pueden ser clave de diccionarios</a>, por lo tanto, en nuestro diccionario bidireccional, tanto las claves como los valores deberán serlo.</p>
<h4>Actualizaciones</h4>

<p>Otra limitación de este enfoque son las desincronizaciones que puede sufrir al modificar el <em>bidict</em> luego de realizar la transformación; hay que tener cuidado!</p>
<ul>

    <li>Luego de agregar un nuevo elemento debemos volver a ejecutar la línea mágica para que cree la entrada inversa.</li>

    <li>No podemos agregar un par que tenga como clave algo que ya existía como valor o que tenga como valor algo que ya existía como clave.</li>

    <li>Si borramos una entrada, hay que también borrar su inversa.</li>

</ul>

<h3>Conclusión personal</h3>

<p>Como les contaba antes, yo estaba usando el diccionario original en un archivo de configuración, por lo que no toco la estructura de datos durante la ejecución del programa, así que esta solución compacta y elegante... como dijo el filósofo: <strong>me viene al pelo!</strong></p>
<p>Espero a alguien más le sirva.</p>
</div>
    </div>
    </article>
    <article class="h-entry post-text">
    <header>
        <h1 class="p-name entry-title"><a href="posts/2010/07/23/talk-taint-mode-for-python-via-a-library-video.html" class="u-url">Talk: Taint Mode for Python via a Library (video)</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn">Juanjo</span></p>
            <p class="dateline"><a href="posts/2010/07/23/talk-taint-mode-for-python-via-a-library-video.html" rel="bookmark"><time class="published dt-published" datetime="2010-07-23T13:04:38+00:00" title="2010-07-23 13:04">2010-07-23 13:04</time></a></p>
                <p class="commentline">
        
    <a href="posts/2010/07/23/talk-taint-mode-for-python-via-a-library-video.html#disqus_thread" data-disqus-identifier="cache/posts/2010/07/23/talk-taint-mode-for-python-via-a-library-video.html">Comments</a>


        </p>
</div>
    </header>
    <div class="e-content entry-content">
    <div>
<p></p>
<p>OWASP have just published the video of my talk in <a href="http://www.owasp.org/index.php/OWASP_AppSec_Research_2010_-_Stockholm,_Sweden" target="_blank">OWASP App Sec Research 2010 in Stockholm</a>.</p>
<p>First talk in English ever.</p>
<p><em>Fue mi primer charla en inglés.</em></p>
<p></p>
<center>
<p><embed type="application/x-shockwave-flash" width="480" height="300" src="http://blip.tv/play/AYHwp2QC" allowfullscreen="true"></embed></p>
<p></p>
</center>
<p><a href="http://www.juanjoconti.com.ar/2010/07/06/talk-taint-mode-for-python-via-a-library-slides/" target="_blank">Slides and text</a> are also avaliable.</p>
</div>
    </div>
    </article>
</div>

        <nav class="postindexpager">
        <ul class="pager">
            <li class="previous">
                <a href="index-39.html" rel="prev">Publicaciones posteriores</a>
            </li>
            <li class="next">
                <a href="index-37.html" rel="next">Publicaciones anteriores</a>
            </li>
        </ul>
        </nav>


        
       <script>var disqus_shortname="nikolademo";(function(){var a=document.createElement("script");a.async=true;a.src="//"+disqus_shortname+".disqus.com/count.js";(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(a)}());</script>





        </div>
        <!--End of body content-->

        <footer>
            Contents © 2015         <a href="mailto:jjconti@gmail.com">Juanjo</a> - Powered by         <a href="http://getnikola.com" rel="nofollow">Nikola</a>         
            
        </footer>
    </div>
</div>


            <script src="assets/js/all-nocdn.js"></script>
        <script src="assets/js/colorbox-i18n/jquery.colorbox-es.js"></script>
    
<!-- Social buttons -->
<div id="addthisbox" class="addthis_toolbox addthis_peekaboo_style addthis_default_style addthis_label_style addthis_32x32_style">
<a class="addthis_button_more">Share</a>
<ul>
<li>
<a class="addthis_button_facebook"></a>
</li>
<li>
<a class="addthis_button_google_plusone_share"></a>
</li>
<li>
<a class="addthis_button_linkedin"></a>
</li>
<li>
<a class="addthis_button_twitter"></a>
</li>
</ul>
</div>
<script src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-4f7088a56bb93798"></script>
<!-- End of social buttons -->


    <script>$('a.image-reference:not(.islink)').colorbox({rel:"gal",maxWidth:"100%",maxHeight:"100%",scalePhotos:true});</script>
    <!-- fancy dates -->
    <script>
    moment.locale("es");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script>
    <!-- end fancy dates -->
    


</body>
</html>
